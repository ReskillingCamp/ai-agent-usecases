---
use_case_id: UC-AUT-005
title: 発注書作成自動化システム
category: General Business
sub_category: Operations Automation
complexity_level: Lv4-5
implementation_types:
  - Automation
  - RPA×AI
tags:
  - 発注書
  - 自動化
  - 購買管理
  - 在庫連携
  - 文書生成
version: 1.0.0
last_updated: 2025-01-15
rag_config:
  knowledge_base_type: 発注書テンプレート・取引先情報・発注ルール
  embedding_strategy: 項目ベースのチャンキング（商品情報、取引条件、発注先、価格）
  chunk_size: 600
  top_k: 5
  similarity_threshold: 0.80
  sample_content: 発注書フォーマット、取引先マスター、発注基準、価格表
---

# 発注書作成自動化システム

## Overview

在庫データや需要予測に基づいて、必要な商品の発注書を自動作成し、取引先へ送信するシステム。AIが在庫レベル、発注リードタイム、過去の発注実績を分析し、最適な発注タイミングと数量を判断します。ナレッジベースに取引先情報や発注ルールを登録することで、正確で迅速な発注業務を実現。発注書作成時間を90%削減し、在庫切れと過剰在庫の両方を防止します。

## Business Value

- 時間削減: 発注書作成時間を90%削減（30分/件→3分/件）
- コスト削減: 発注業務の自動化により年間約400万円のコスト削減（月100件発注の場合）
- 品質向上: 発注ミス防止、最適在庫レベル維持、欠品率50%削減
- その他の効果: キャッシュフロー改善、取引先との関係強化（定時発注）、購買データの可視化

## Required Components

- LLM（GPT-4、Claude等）
- 在庫管理システム連携API
- ベクトルデータベース（Pinecone, Qdrant, Weaviate等）
- Difyワークフロー機能
- RPAツール（UiPath、Power Automate等、オプション）
- 文書生成ツール（PDF、Excel出力）
- メール送信システム

## Implementation Steps

1. 発注書テンプレート・取引先情報・発注ルールをナレッジベースに登録
2. 在庫管理システムとの連携を設定（在庫レベル、発注点の取得）
3. 発注要否判定ロジックを構築（在庫レベル、リードタイム、需要予測）
4. RAG検索で取引先情報・価格情報を取得するワークフローを構築
5. 発注数量最適化プロンプトを設定（経済的発注量、ロット単位等）
6. 発注書自動生成機能を実装（テンプレート適用、必須項目埋め込み）
7. 発注書の自動チェック機能を実装（金額、数量、取引条件の妥当性）
8. サンプルデータでテストし、発注内容の精度を検証
9. 取引先への自動送信機能を実装（メール、EDI等）
10. 実運用開始（在庫監視→発注判定→発注書作成→送信）

## Sample Prompts

```
以下の在庫データから、発注が必要な商品を判定してください：

在庫データ: {inventory_data}
発注点設定: {reorder_point}
リードタイム: {lead_time}
今後の需要予測: {demand_forecast}

判定項目：
1. 発注が必要な商品のリスト
2. 推奨発注数量（経済的発注量を考慮）
3. 発注の緊急度（高・中・低）
4. 発注理由（在庫切れ予測日、安全在庫割れ等）

JSON形式で発注推奨リストを返してください。
```

```
以下の情報を基に発注書を作成してください：

商品情報: {product_info}
発注数量: {order_quantity}
取引先情報: {supplier_info}
取引条件: {terms_conditions}

発注書に含める内容：
1. 発注番号（自動採番）
2. 発注日、希望納期
3. 商品明細（商品コード、商品名、数量、単価、金額）
4. 合計金額（税込・税抜）
5. 納品先情報
6. 支払条件
7. 特記事項

発注書テンプレートに従って、正確な発注書を生成してください。
```

```
以下の発注内容が適切か検証してください：

発注内容: {order_details}
過去の発注実績: {historical_orders}
在庫状況: {current_inventory}
予算制約: {budget_constraint}

確認項目：
1. 発注数量は適切か（過去実績との比較）
2. 単価は妥当か（価格変動のチェック）
3. 納期設定は実現可能か
4. 予算内に収まっているか
5. 重複発注がないか

問題点と改善提案を提示してください。
```

## Data Requirements

- データの種類: 発注書テンプレート、取引先マスター、商品マスター、価格表、発注履歴
- データ量: テンプレート5-20種類、取引先100-1,000社、商品1,000-10,000種、発注履歴6-12ヶ月分
- データ形式: Excel、PDF（テンプレート）、CSV（マスターデータ）、データベース（発注履歴）
- データ準備:
  1. 発注書テンプレートの標準化
  2. 取引先マスターの整備・更新
  3. 商品マスターと価格情報の最新化
  4. 発注ルール・発注点の設定
  5. 過去発注データのクレンジング

## Technical Considerations

- システム要件: LLM API（月間1,000-3,000リクエスト）、在庫システム連携、ベクトルDB（3,000-10,000エントリー）、文書生成ツール
- セキュリティ: 取引先情報・価格情報の機密管理、アクセス制御、発注承認ワークフロー、監査ログ
- パフォーマンス: 発注要否判定は5分以内、発注書生成は1分/件以内、バッチ処理は夜間実行
- 制限事項:
  - 初回発注や特殊案件は人間確認が必須
  - 価格交渉が必要な案件は自動化困難
  - 在庫システムとのリアルタイム連携が必要
  - 取引先のシステム対応状況により送信方法が異なる（メール、EDI、手動等）
  - 為替変動や市況変化への対応は別途必要
- スケーラビリティ: 月間500件の発注まで対応可能、それ以上は処理能力の増強が必要

## Reference Links

- https://www.dify.ai/blog/procurement-automation
- https://www.oracle.com/scm/procurement-cloud/
- https://dynamics.microsoft.com/supply-chain-management/
- https://www.sap.com/products/spend-management/procurement.html

## Tags

- 発注書
- 自動化
- 購買管理
- 在庫連携
- 文書生成
- 需要予測
- サプライチェーン
- ワークフロー
